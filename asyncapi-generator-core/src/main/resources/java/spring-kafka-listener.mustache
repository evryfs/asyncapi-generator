package {{packageName}};

import org.apache.kafka.clients.consumer.ConsumerRecord;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Component;
import org.springframework.boot.autoconfigure.condition.ConditionalOnBean;
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;
{{#imports}}
import {{.}};
{{/imports}}

/**
{{#description}}
 * {{.}}
{{/description}}
 */
@Component
@ConditionalOnBean({{handlerInterface}}.class)
@ConditionalOnProperty(name = "{{topicPropertyKey}}")
public class {{name}} {

    private static final Logger log = LoggerFactory.getLogger({{name}}.class);
    private final {{handlerInterface}} handler;

    public {{name}}({{handlerInterface}} handler) {
        this.handler = handler;
    }

    {{=<% %>=}}
    @KafkaListener(topics = "${<%topicPropertyKey%>}", groupId = "<%groupId%>")
    <%={{ }}=%>    public void listen(ConsumerRecord<String, {{payloadType}}> record) {
        log.debug("Dispatching {{payloadType}} from topic {{topic}}");
        handler.{{methodName}}(record);
    }
}
