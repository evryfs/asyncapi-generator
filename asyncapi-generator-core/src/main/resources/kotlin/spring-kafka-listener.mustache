package {{packageName}}

import org.slf4j.LoggerFactory
import org.springframework.kafka.annotation.KafkaListener
import org.springframework.stereotype.Component
import org.springframework.boot.autoconfigure.condition.ConditionalOnBean
import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty
{{#imports}}
import {{{.}}}
{{/imports}}


/**
{{#description}}
 * {{{.}}}
{{/description}}
 */
@Component
@ConditionalOnBean({{handlerInterface}}::class)
@ConditionalOnProperty(name = ["{{topicPropertyKey}}"])
class {{name}}(
    private val handler: {{handlerInterface}}
) {

    private val log = LoggerFactory.getLogger({{name}}::class.java)
{{=<% %>=}}
    @KafkaListener(topics = ["\${<%topicPropertyKey%>}"], groupId = "<%groupId%>")
<%={{ }}=%>    fun listen(record: ConsumerRecord<String, {{payloadType}}>) {
            log.debug("Dispatching {{payloadType}} from topic {{topic}}")
            handler.{{methodName}}(record)
        }
    }
